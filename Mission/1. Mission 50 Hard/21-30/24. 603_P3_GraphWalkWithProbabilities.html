<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Hero is playing a game on a directed graph.
The graph has N nodes, numbered 0 through N-1.
Each node of the graph has two associated probabilities: <b>winprob</b>[i] and <b>loseprob</b>[i].

At the beginning of the game, Hero takes a token and places it onto the node <b>start</b>.
The game then proceeds in turns.
Each turn consists of the following steps:
<ol>
<li>Let x be the node currently occupied by the token.</li>
<li>Hero picks a node y. The node y must either be the current node (i.e., y=x), or there must be an edge from x to y.</li>
<li>Hero moves the token from x to y.</li>
<li>One of three outcomes is chosen at random: With probability <b>winprob</b>[y] percent the game ends and Hero wins. With probability <b>loseprob</b>[y] percent the game ends and Hero loses. In all other cases (i.e., with probability 100-<b>winprob</b>[y]-<b>loseprob</b>[y] percent) the game continues.</li>
</ol>

You are given a vector &lt;string&gt; <b>graph</b> that describes the graph.
More precisely, for each valid i and j, <b>graph</b>[i][j] is '1' if there is an edge from i to j, and it is '0' otherwise.
Note that for all i, <b>graph</b>[i][i] is '1' to indicate that it is always allowed to stay in a node.
You are also given the vector &lt;int&gt;s <b>winprob</b> and <b>loseprob</b>, and the int <b>start</b>.
Assuming that Hero plays the game optimally, return a real number between 0 and 1, inclusive: the probability that he wins the game.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>GraphWalkWithProbabilities</td></tr><tr><td>Method:</td><td>findprob</td></tr><tr><td>Parameters:</td><td>vector &lt;string&gt;, vector &lt;int&gt;, vector &lt;int&gt;, int</td></tr><tr><td>Returns:</td><td>double</td></tr><tr><td>Method signature:</td><td>double findprob(vector &lt;string&gt; graph, vector &lt;int&gt; winprob, vector &lt;int&gt; looseprob, int Start)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>Your return value must have an absolute or a relative error less than 1e-9.</td></tr><tr><td align="center" valign="top">-</td><td>Note that the input probabilities (<b>winprob</b>, <b>loseprob</b>) are given in percents but the return value is not.</td></tr><tr><td align="center" valign="top">-</td><td>The constraints guarantee that with probability 1 the game will end.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td>Number of elemets in <b>graph</b> is equal to number of nodes N.</td></tr><tr><td align="center" valign="top">-</td><td>N will be between 1 and 50, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>graph</b> will contain exactly N characters.</td></tr><tr><td align="center" valign="top">-</td><td>Each character in <b>graph</b> will be either '0' or '1'.</td></tr><tr><td align="center" valign="top">-</td><td><b>graph</b>[i][i] will be equal to '1' for all i between 0 and N-1, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>winprob</b> and <b>loseprob</b> will contain exactly N elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>winprob</b> and <b>loseprob</b> will be between 0 and 100, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>For each i, the sum of <b>winprob</b>[i] and <b>loseprob</b>[i] will be at least 1.</td></tr><tr><td align="center" valign="top">-</td><td><b>start</b> will be between 0 and N-1, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;1&quot;}</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0.5</pre></td></tr><tr><td><table><tr><td colspan="2">In each turn, Hero has to stay in the only node. 
After each turn, he wins the game with probability 1% and loses the game with probability 1%.
By the symmetry of the situation, his overall probability of winning the game has to be 50%, hence the correct return value is 0.5.

Note that as the number of turns increases, the probability that the game is still going on decreases towards zero.
Specifically, the probability that the game still runs after k turns is 0.98^k.
Therefore, the probability of Hero playing the game forever without winning or losing it is 0.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;11&quot;,&quot;11&quot;}</pre></td></tr><tr><td><pre>{60,40}</pre></td></tr><tr><td><pre>{40,60}</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0.6</pre></td></tr><tr><td><table><tr><td colspan="2">At the first turn Hero can choose to stay at node 0 or to move token to node 1.
After he made choice game will end at the end of turn. First node has better probability of winning, so optimal play is to stay at node 0 and win with probability of 60 percents.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;11&quot;,&quot;11&quot;}</pre></td></tr><tr><td><pre>{2,3}</pre></td></tr><tr><td><pre>{3,4}</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0.4285714285714286</pre></td></tr><tr><td><table><tr><td colspan="2">Here optimal play is to move to node 1 at first turn and stay there until end of game, in this way answer is 3/7.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;110&quot;,&quot;011&quot;,&quot;001&quot;}</pre></td></tr><tr><td><pre>{2,1,10}</pre></td></tr><tr><td><pre>{20,20,10}</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0.405</pre></td></tr><tr><td><table><tr><td colspan="2">Nodes number 0 and 1 have too weak probability of winning, so Hero moves to node number 1 at first turn, to node 2 at second turn, and waits for end.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;111&quot;,&quot;111&quot;,&quot;011&quot;}</pre></td></tr><tr><td><pre>{100,1,1}</pre></td></tr><tr><td><pre>{0,50,50}</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0.5</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
